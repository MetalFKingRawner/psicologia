{% extends 'base.html' %}
{% load static %}

{% block title %}Test de Dominó D-48{% endblock %}

{% block content %}
<div class="container my-5">
    <div class="card shadow-lg">
        <div class="card-header bg-primary text-white">
            <h2 class="text-center" style="color:white">Test de Dominó D-48</h2>
        </div>
        <div class="card-body">
            <div class="text-center mb-4">
                <img src="{% static 'img/domino.jpg' %}" alt="Icono Dominó" width="120" class="mb-3">
                <h3 class="text-primary">Instrucciones Generales</h3>
            </div>
            
            <div class="row">
                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header bg-info text-white">
                            <h4><i class="fas fa-info-circle me-2"></i>Acerca del Test</h4>
                        </div>
                        <div class="card-body">
                            <p>El Test de Dominó D-48 es una prueba de inteligencia no verbal que evalúa tu capacidad de razonamiento abstracto.</p>
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item">
                                    <i class="fas fa-clock me-2"></i>
                                    <strong>Tiempo límite:</strong> {{ test.tiempo_limite }} minutos
                                </li>
                                <li class="list-group-item">
                                    <i class="fas fa-list-ol me-2"></i>
                                    <strong>Problemas:</strong> 48 ejercicios
                                </li>
                                <li class="list-group-item">
                                    <i class="fas fa-brain me-2"></i>
                                    <strong>Habilidad medida:</strong> Razonamiento lógico
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header bg-info text-white">
                            <h4><i class="fas fa-lightbulb me-2"></i>Cómo resolver</h4>
                        </div>
                        <div class="card-body">
                            <p>Cada problema muestra una secuencia de fichas de dominó. Tu tarea es descubrir la lógica de la secuencia y seleccionar la ficha que completa el patrón.</p>
                            
                            <div class="alert alert-warning">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                <strong>Importante:</strong> Las fichas pueden relacionarse horizontal y verticalmente
                            </div>
                            
                            <ol>
                                <li>Observa las fichas disponibles</li>
                                <li>Identifica el patrón o relación</li>
                                <li>Determina qué valores deben tener la ficha faltante</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ejemplo Práctico -->
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <h4 style="color: white;"><i class="fas fa-graduation-cap me-2" style="color: white;"></i>Ejemplo Práctico</h4>
                </div>
                <div class="card-body">
                    <p class="mb-4"><strong>Observa este patrón de dominó y trata de identificar la lógica antes de ver la solución:</strong></p>
                    
                    <!-- Contenedor del ejemplo de dominó -->
                    <div class="domino-example-container mb-4">
                        <div class="domino-grid">
                            <!-- Primera fila -->
                            <div class="domino-tile">
                                <div class="domino-half dots-1">
                                    <div class="dot dot-1"></div>
                                </div>
                                <div class="domino-half dots-2">
                                    <div class="dot dot-1"></div>
                                    <div class="dot dot-2"></div>
                                </div>
                            </div>

                            <div class="domino-tile">
                                <div class="domino-half dots-2">
                                    <div class="dot dot-1"></div>
                                    <div class="dot dot-2"></div>
                                </div>
                                <div class="domino-half dots-3">
                                    <div class="dot dot-1"></div>
                                    <div class="dot dot-2"></div>
                                    <div class="dot dot-3"></div>
                                </div>
                            </div>

                            <div class="domino-tile">
                                <div class="domino-half dots-3">
                                    <div class="dot dot-1"></div>
                                    <div class="dot dot-2"></div>
                                    <div class="dot dot-3"></div>
                                </div>
                                <div class="domino-half dots-4">
                                    <div class="dot dot-1"></div>
                                    <div class="dot dot-2"></div>
                                    <div class="dot dot-3"></div>
                                    <div class="dot dot-4"></div>
                                </div>
                            </div>

                            <!-- Segunda fila -->
                            <div class="domino-tile">
                                <div class="domino-half dots-2">
                                    <div class="dot dot-1"></div>
                                    <div class="dot dot-2"></div>
                                </div>
                                <div class="domino-half dots-1">
                                    <div class="dot dot-1"></div>
                                </div>
                            </div>

                            <div class="domino-tile">
                                <div class="domino-half dots-3">
                                    <div class="dot dot-1"></div>
                                    <div class="dot dot-2"></div>
                                    <div class="dot dot-3"></div>
                                </div>
                                <div class="domino-half dots-2">
                                    <div class="dot dot-1"></div>
                                    <div class="dot dot-2"></div>
                                </div>
                            </div>

                            <!-- Ficha con la respuesta correcta (inicialmente oculta) -->
                            <div class="domino-tile solution-tile" id="solutionTile">
                                <div class="domino-half dots-4">
                                    <div class="dot dot-1"></div>
                                    <div class="dot dot-2"></div>
                                    <div class="dot dot-3"></div>
                                    <div class="dot dot-4"></div>
                                </div>
                                <div class="domino-half dots-3">
                                    <div class="dot dot-1"></div>
                                    <div class="dot dot-2"></div>
                                    <div class="dot dot-3"></div>
                                </div>
                            </div>

                            <!-- Ficha vacía que se mostrará inicialmente -->
                            <div class="domino-tile respuesta" id="emptyTile">
                                <div class="domino-half">
                                    <span class="question-mark">?</span>
                                </div>
                                <div class="domino-half">
                                    <span class="question-mark">?</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Botón para mostrar solución -->
                    <div class="text-center mb-4">
                        <button class="btn btn-warning" id="showSolutionBtn">
                            <i class="fas fa-eye me-2"></i>Ver Solución
                        </button>
                        <button class="btn btn-secondary d-none" id="hideSolutionBtn">
                            <i class="fas fa-eye-slash me-2"></i>Ocultar Solución
                        </button>
                    </div>

                    <!-- Explicación de la solución -->
                    <div class="solution-explanation d-none" id="solutionExplanation">
                        <div class="alert alert-success">
                            <h5><i class="fas fa-lightbulb me-2"></i>Explicación de la Solución</h5>
                            <div class="row">
                                <div class="col-md-6">
                                    <h6><strong>Patrón Horizontal:</strong></h6>
                                    <ul class="small">
                                        <li><strong>Fila 1:</strong> 1→2, 2→3, 3→4 (incremento de +1)</li>
                                        <!-- <li><strong>Fila 2:</strong> 2→1, 3→2, 4→3 (decremento de -1)</li> -->
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h6><strong>Patrón Vertical:</strong></h6>
                                    <ul class="small">
                                        <li><strong>Columna 1:</strong> Mitades superiores: 1→2 (+1)</li>
                                        <!-- <li><strong>Col 1:</strong> Mitades inferiores: 2→1 (-1)</li> -->
                                        <li><strong>Columna 2:</strong> Similar patrón alternado</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="mt-3 p-3 bg-light rounded">
                                <strong>Respuesta correcta:</strong> La ficha faltante debe tener <span class="badge bg-success fs-6">4 puntos arriba</span> y <span class="badge bg-success fs-6">3 puntos abajo</span>
                            </div>
                        </div>
                    </div>

                    <!-- <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Recuerda:</strong> En el test real tendrás opciones múltiples para elegir la respuesta correcta.
                    </div> -->
                </div>
            </div>
            
            <div class="text-center mt-4">
                <div class="alert alert-primary">
                    <h5><i class="fas fa-play-circle me-2"></i>¿Listo para el desafío?</h5>
                    <p class="mb-0">Ahora que entiendes cómo funciona, ¡pon a prueba tu razonamiento lógico!</p>
                </div>
                
                <a href="{% url 'test_domino' %}" class="btn btn-primary btn-lg px-5 py-3">
                    <i class="fas fa-play me-2"></i>Comenzar Test
                </a>
                
                <div class="mt-3">
                    <small class="text-muted">Recuerda: observa tanto los patrones horizontales como verticales</small>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* Estilos para el ejemplo de dominó */
    .domino-example-container {
        background-color: #f8f9fa;
        padding: 30px;
        border-radius: 15px;
        border: 2px solid #e9ecef;
    }

    .domino-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        max-width: 400px;
        margin: 0 auto;
    }

    .domino-tile {
        width: 70px;
        height: 140px;
        background: linear-gradient(145deg, #ffffff, #f0f0f0);
        border: 2px solid #d1d1d1;
        border-radius: 10px;
        display: flex;
        flex-direction: column;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        position: relative;
    }

    .domino-tile.solution-tile {
        border: 3px solid #28a745;
        background: linear-gradient(145deg, #d4edda, #c3e6cb);
        box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
    }

    .domino-tile.respuesta {
        border: 2px dashed #6c757d;
        background-color: #f8f9fa;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .domino-half {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        position: relative;
    }

    .domino-half:first-child {
        border-bottom: 2px solid #bababa;
    }

    .domino-tile.respuesta .domino-half:first-child {
        border-bottom: 2px dashed #6c757d;
    }

    .dot {
        width: 10px;
        height: 10px;
        background-color: #2c3e50;
        border-radius: 50%;
        position: absolute;
    }

    .question-mark {
        font-size: 24px;
        font-weight: bold;
        color: #6c757d;
    }

    /* Patrones de posición para los puntos */
    .dots-1 .dot-1 {
        top: 50%; left: 50%;
        transform: translate(-50%, -50%);
    }

    .dots-2 .dot-1 {
        top: 30%; left: 30%;
        transform: translate(-50%, -50%);
    }
    .dots-2 .dot-2 {
        top: 70%; left: 70%;
        transform: translate(-50%, -50%);
    }

    .dots-3 .dot-1 {
        top: 25%; left: 25%;
        transform: translate(-50%, -50%);
    }
    .dots-3 .dot-2 {
        top: 50%; left: 50%;
        transform: translate(-50%, -50%);
    }
    .dots-3 .dot-3 {
        top: 75%; left: 75%;
        transform: translate(-50%, -50%);
    }

    .dots-4 .dot-1 {
        top: 25%; left: 25%;
        transform: translate(-50%, -50%);
    }
    .dots-4 .dot-2 {
        top: 25%; left: 75%;
        transform: translate(-50%, -50%);
    }
    .dots-4 .dot-3 {
        top: 75%; left: 25%;
        transform: translate(-50%, -50%);
    }
    .dots-4 .dot-4 {
        top: 75%; left: 75%;
        transform: translate(-50%, -50%);
    }

    .dots-5 .dot-1 {
        top: 25%; left: 25%;
        transform: translate(-50%, -50%);
    }
    .dots-5 .dot-2 {
        top: 25%; left: 75%;
        transform: translate(-50%, -50%);
    }
    .dots-5 .dot-3 {
        top: 50%; left: 50%;
        transform: translate(-50%, -50%);
    }
    .dots-5 .dot-4 {
        top: 75%; left: 25%;
        transform: translate(-50%, -50%);
    }
    .dots-5 .dot-5 {
        top: 75%; left: 75%;
        transform: translate(-50%, -50%);
    }

    .dots-6 .dot-1 {
        top: 25%; left: 25%;
        transform: translate(-50%, -50%);
    }
    .dots-6 .dot-2 {
        top: 25%; left: 75%;
        transform: translate(-50%, -50%);
    }
    .dots-6 .dot-3 {
        top: 50%; left: 25%;
        transform: translate(-50%, -50%);
    }
    .dots-6 .dot-4 {
        top: 50%; left: 75%;
        transform: translate(-50%, -50%);
    }
    .dots-6 .dot-5 {
        top: 75%; left: 25%;
        transform: translate(-50%, -50%);
    }
    .dots-6 .dot-6 {
        top: 75%; left: 75%;
        transform: translate(-50%, -50%);
    }

    /* Animaciones para la solución */
    .solution-tile {
        animation: highlightSolution 2s ease-in-out;
    }

    @keyframes highlightSolution {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
    }

    /* Responsive */
    @media (max-width: 768px) {
        .domino-grid {
            gap: 15px;
            max-width: 300px;
        }
        
        .domino-tile {
            width: 60px;
            height: 120px;
        }
        
        .dot {
            width: 8px;
            height: 8px;
        }
        
        .question-mark {
            font-size: 20px;
        }
    }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const showBtn = document.getElementById('showSolutionBtn');
    const hideBtn = document.getElementById('hideSolutionBtn');
    const explanation = document.getElementById('solutionExplanation');
    const solutionTile = document.getElementById('solutionTile');
    const emptyTile = document.getElementById('emptyTile');

    // Inicialmente ocultar la ficha solución
    solutionTile.style.display = 'none';

    showBtn.addEventListener('click', function() {
        // Mostrar solución
        emptyTile.style.display = 'none';
        solutionTile.style.display = 'flex';
        explanation.classList.remove('d-none');
        
        // Cambiar botones
        showBtn.classList.add('d-none');
        hideBtn.classList.remove('d-none');
        
        // Trigger animation
        solutionTile.style.animation = 'none';
        setTimeout(() => {
            solutionTile.style.animation = 'highlightSolution 2s ease-in-out';
        }, 10);
    });

    hideBtn.addEventListener('click', function() {
        // Ocultar solución
        solutionTile.style.display = 'none';
        emptyTile.style.display = 'flex';
        explanation.classList.add('d-none');
        
        // Cambiar botones
        hideBtn.classList.add('d-none');
        showBtn.classList.remove('d-none');
    });
});
</script>

{% endblock %}